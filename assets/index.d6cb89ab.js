import{d as O,s as j,a as x,o as u,c as a,b as o,n as b,t as g,e as k,F as v,r as _,f as y,u as d,w as I,g as G,T as J,h as B,i as w,j as V,k as Q,v as X,l as Y,m as Z,p as ee}from"./vendor.171b7ae9.js";const se=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const l of t)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function n(t){const l={};return t.integrity&&(l.integrity=t.integrity),t.referrerpolicy&&(l.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?l.credentials="include":t.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(t){if(t.ep)return;t.ep=!0;const l=n(t);fetch(t.href,l)}};se();const F=O("idioms",{state:()=>({allIdioms:j({}),freqIdioms:j([])}),getters:{isValidIdiom(e){return s=>s in e.allIdioms},randomIdiom(e){return()=>{const s=Math.floor(Math.random()*e.freqIdioms.length);return e.freqIdioms[s]}}},actions:{setAllIdioms(e){this.allIdioms=e},setFreqIdioms(e){this.freqIdioms=e}}}),L=[..."bpmfdtnlgkhjqxzcsr"],R=["zh","ch","sh"],ne=[...L,...R],te=["a","o","e","ai","ei","ao","ou","an","en","ang","eng","er","i","ia","ie","iao","iou","ian","in","iang","ing","iong","u","ua","uo","uai","uei","uan","uen","uang","ueng","\xFC","\xFCe","\xFCan","\xFCn","ong"],q=["\u0304","\u0301","\u030C","\u0300"],D=e=>{let s=0;for(let i=0;i<q.length;i++)e.normalize("NFD").includes(q[i])&&(s=i+1);return[e.normalize("NFD").replace(/\u0304|\u0301|\u030C|\u0300/,"").normalize(),s]},A=e=>{switch(e){case"iu":return"iou";case"ui":return"uei";case"un":return"uen";default:return e}},ie=e=>{let[s,n]=D(e);if("jqx".includes(s[0])&&s[1]==="u"&&(s=s.replace("u","\xFC")),s.startsWith("y"))switch(s[1]){case"i":s=s.slice(1);break;case"u":s=`\xFC${s.slice(2)}`;break;default:s=`i${s.slice(1)}`;break}else s.startsWith("w")&&(s=s[1]==="u"?s.slice(1):`u${s.slice(1)}`);return R.includes(s.slice(0,2))?[s.slice(0,2),A(s.slice(2)),n]:L.includes(s.charAt(0))?[s.charAt(0),A(s.slice(1)),n]:["",A(s),n]},N=e=>e.split(" ").map(ie);var C;(function(e){e[e.NotExists=0]="NotExists",e[e.Exists=1]="Exists",e[e.CorrectPosition=2]="CorrectPosition"})(C||(C={}));var M;(function(e){e[e.GiveCombination_IfBothEverGuessed=0]="GiveCombination_IfBothEverGuessed",e[e.GiveCombination_IfBothExistsInOneGuess=1]="GiveCombination_IfBothExistsInOneGuess",e[e.GiveTone_IfCombinationCorrect=2]="GiveTone_IfCombinationCorrect",e[e.GiveCharacter_IfBothPositionCorrect=3]="GiveCharacter_IfBothPositionCorrect"})(M||(M={}));const le=O("guess",{state:()=>({answerIdiom:null,guessedIdioms:[],hints:[],enabledHints:[0,2,3]}),getters:{answerOrigPinyin(e){return e.answerIdiom===null?null:F().allIdioms[e.answerIdiom]},answerPinyin(){return this.answerOrigPinyin===null?null:N(this.answerOrigPinyin)},answerPinyinFlatten(){return this.answerPinyin===null?null:this.answerPinyin.flatMap(([e,s])=>[e,s])},answerSyllables(){return this.answerPinyin===null?null:this.answerPinyin.map(([e,s])=>e+s)},compareIdiomPinyin(){return e=>{if(this.answerPinyinFlatten===null||this.answerSyllables===null)throw new Error("answer is not set");return e.map(([s,n],i)=>{const[t,l]=[s,n].map((h,p)=>this.answerPinyin[i][p]===h?2:this.answerPinyinFlatten.includes(h)?1:0),r=this.answerSyllables.includes(s+n);return[t,l,r]})}},guesses(){const e=F();return this.guessedIdioms.map(s=>{const n=e.allIdioms[s],i=N(n);return{idiom:s,pinyin:i,origPinyin:n,result:this.compareIdiomPinyin(i)}})},guessesPinyin(){return this.guesses.map(e=>e.pinyin)},guessesPinyinFlatten(){return this.guessesPinyin.flatMap(e=>e.flatMap(([s,n])=>[s,n]))},guessesSyllables(){return this.guessesPinyin.map(e=>e.map(([s,n])=>s+n))},guessesSyllablesFlatten(){return this.guessesSyllables.flat()},won(){return this.guesses.length!==0&&this.guesses[this.guesses.length-1].result.every(e=>e[0]===2&&e[1]===2)},includeList(){return this.answerPinyinFlatten===null?[]:this.answerPinyinFlatten.filter(e=>this.guessesPinyinFlatten.includes(e))},excludeList(){return this.answerPinyinFlatten===null?[]:this.guessesPinyinFlatten.filter(e=>!this.answerPinyinFlatten.includes(e))}},actions:{initAnswerIdiom(e){this.answerIdiom=e},guessIdiom(e){return F().isValidIdiom(e)?(this.guessedIdioms.push(e),this.won||this.updateHints(),!0):!1},updateHints(){if(!this.answerIdiom||!this.answerOrigPinyin)return[];const e=[];for(const[s,n]of this.answerPinyin.entries()){const[i,t]=n,l=i+t,r=this.answerOrigPinyin.split(" ")[s];if(this.enabledHints.includes(3)&&this.guessesSyllables.findIndex(h=>h[s]===l)!==-1){e.push(this.answerIdiom.charAt(s));continue}if(this.enabledHints.includes(2)&&this.guessesSyllablesFlatten.includes(l)){e.push(r);continue}if(this.enabledHints.includes(0)&&this.guessesPinyinFlatten.includes(i)&&this.guessesPinyinFlatten.includes(t)){e.push(D(r)[0]);continue}if(this.enabledHints.includes(1)&&this.guessesPinyin.findIndex(h=>{const p=h.flatMap(([P,$])=>[P,$]);return p.includes(i)&&p.includes(t)})!==-1){e.push(D(r)[0]);continue}}this.hints.push(...e.filter(s=>!this.hints.includes(s)))}}}),re={class:"p-0.5 w-16 h-16"},ue={class:"text-sm font-mono font-semibold"},oe=o("div",{class:"text-blue-500 text-xs"}," + ",-1),ae={key:1,class:"text-center"},de={class:"mt-1 text-center"},U=x({props:{char:null,pinyin:null,guessResults:null},setup(e){const s={[C.NotExists]:"gray-500",[C.Exists]:"yellow-500",[C.CorrectPosition]:"green-500"};return(n,i)=>(u(),a("div",re,[o("div",ue,[Array.isArray(e.pinyin)&&e.guessResults?(u(),a("div",{key:0,class:b(["flex justify-center items-baseline decoration-green-500",e.guessResults[2]?["underline"]:[]]),"w:underline":"offset-1 double"},[o("div",{class:b(`text-${s[e.guessResults[0]]}`)},g(e.pinyin[0]||"\xD8"),3),oe,o("div",{class:b(`text-${s[e.guessResults[1]]}`)},g(e.pinyin[1]),3)],2)):(u(),a("div",ae,g(e.pinyin),1))]),o("div",de,g(e.char),1)]))}});const ce={class:"flex justify-center my-1 first-child:border-l-2 children:border-2 children:border-l-0 children:border-dashed children:border-red-200"},he=x({props:{idiom:null,pinyin:null,guessResults:null},setup(e){const s=e,n=k(()=>s.pinyin.map((i,t)=>({char:s.idiom.charAt(t),pinyin:i,guessResults:s.guessResults[t]})));return(i,t)=>(u(),a("div",ce,[(u(!0),a(v,null,_(d(n),(l,r)=>(u(),y(U,{key:r,char:l.char,pinyin:l.pinyin,"guess-results":l.guessResults},null,8,["char","pinyin","guess-results"]))),128))]))}});var z=(e,s)=>{const n=e.__vccOpts||e;for(const[i,t]of s)n[i]=t;return n};const me={};function fe(e,s){return u(),y(J,{"enter-active-class":"duration-300 ease-out","enter-from-class":"transform opacity-0","enter-to-class":"opacity-100","leave-active-class":"duration-200 ease-in","leave-from-class":"opacity-100","leave-to-class":"transform opacity-0"},{default:I(()=>[G(e.$slots,"default")]),_:3})}var K=z(me,[["render",fe]]);const ye={class:"bg-white rounded-lg mx-3 max-w-md p-2","w:border":"t-9 teal-600","w:shadow":"lg gray-500"},T=x({props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:s}){return(n,i)=>(u(),y(K,null,{default:I(()=>[e.modelValue?(u(),a("div",{key:0,class:"absolute w-full h-full flex justify-center items-center z-10","w:bg":"opacity-25 black",onClick:i[0]||(i[0]=t=>s("update:modelValue",!e.modelValue))},[o("div",ye,[G(n.$slots,"default")])])):B("",!0)]),_:3}))}}),pe=o("h1",{class:"text-lg text-center mb-2"}," \u5F85\u731C\u6210\u8BED ",-1),ge={class:"flex justify-center first-child:border-l-2 children:border-2 children:border-l-0 children:border-dashed children:border-red-200"},we=x({props:{answer:null,answerPinyin:null},setup(e){const s=e,n=w(!0),i=k(()=>s.answerPinyin.split(" ").map((t,l)=>({char:s.answer.charAt(l),pinyin:t})));return(t,l)=>(u(),y(T,{modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=r=>n.value=r)},{default:I(()=>[pe,o("div",ge,[(u(!0),a(v,null,_(d(i),(r,h)=>(u(),y(U,{key:h,char:r.char,pinyin:r.pinyin},null,8,["char","pinyin"]))),128))])]),_:1},8,["modelValue"]))}}),xe={},ve={class:"px-4"},_e=o("h1",{class:"text-lg text-center mb-2"}," \u5173\u4E8E ",-1),be=o("p",null,"\u5728\u4E0B\u65B9\u7684\u8F93\u5165\u6846\u4E2D\u8F93\u5165\u4EFB\u610F\u4E00\u4E2A\u56DB\u5B57\u6210\u8BED\u5F00\u59CB\u6E38\u620F\u3002",-1),Ie=[_e,be];function Ce(e,s){return u(),a("div",ve,Ie)}var Pe=z(xe,[["render",Ce]]);const Fe={class:"flex flex-1 my-2"},$e=o("div",null,"\u63D0\u793A",-1),Ee=x({props:{hints:null},setup(e){return(s,n)=>(u(),a("div",Fe,[$e,(u(!0),a(v,null,_(e.hints,i=>(u(),a("div",{key:i,class:"rounded-full px-2 m-1 bg-green-500 text-gray-100"},g(i),1))),128))]))}}),ke=o("h1",{class:"text-lg text-center mb-2"}," \u58F0\u6BCD\u8868 ",-1),Be={class:"flex flex-wrap max-w-full"},Ve=o("h1",{class:"text-lg text-center mb-2"}," \u97F5\u6BCD\u8868 ",-1),De={class:"flex flex-wrap max-w-full"},Ae=x({props:{excluded:null,included:null},setup(e){const s=e,n=w(!1),i=t=>s.excluded.includes(t)?"bg-gray-300":s.included.includes(t)?"bg-green-500":"bg-blue-400";return(t,l)=>(u(),y(T,{modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=r=>n.value=r)},{default:I(()=>[ke,o("div",Be,[(u(!0),a(v,null,_([...d(ne),""],r=>(u(),a("div",{key:r,class:b(["rounded-full px-2 m-1 text-white font-mono",i(r)])},g(r||"\xD8"),3))),128))]),Ve,o("div",De,[(u(!0),a(v,null,_(d(te),r=>(u(),a("div",{key:r,class:b(["rounded-full px-2 m-1 text-white",i(r)])},g(r),3))),128))])]),_:1},8,["modelValue"]))}});var Se="/assets/all-idioms.15fdd005.json",Oe="/assets/freq-idioms.4e747394.json";const je={class:"p-4 mx-auto max-w-2xl"},Ge={class:"flex","w:border":"b-1 solid gray-300","w:p":"b-2"},Le=o("h1",{class:"flex-1","w:text":"3xl center blue-900"}," \u731C\u6210\u8BED ",-1),Re={key:0},qe={class:"flex"},Ne={class:"grid grid-cols-1 sm:grid-cols-2"},Me=o("div",{class:"h-10"},null,-1),Ue={class:"fixed bottom-2 left-1/2 transform -translate-x-1/2"},ze={key:0,class:"px-2 py-1 rounded-md bg-red-500 text-white"},Ke={class:"flex justify-center mt-3"},Te=["disabled","onKeyup"],He=["disabled"],We=x({setup(e){const s=F(),n=le(),i=w(""),t=w(""),l=w(null),r=w(!1),h=w(!1),p=w(!1),P=k(()=>p.value||n.guessedIdioms.length>=10||n.won),$=()=>{n.$reset(),n.initAnswerIdiom(s.randomIdiom()),p.value=!1},E=c=>{l.value!==null&&clearTimeout(l.value),t.value=c,l.value=window.setTimeout(()=>{t.value="",l.value=null},3e3)},S=()=>{n.guessIdiom(i.value)||E("\u4E0D\u662F\u4E00\u4E2A\u6709\u6548\u7684\u56DB\u5B57\u6210\u8BED"),i.value=""};return fetch(Oe).then(c=>c.json()).then(c=>{s.setFreqIdioms(c),n.initAnswerIdiom(s.randomIdiom())}).catch(c=>E(`\u65E0\u6CD5\u83B7\u53D6\u6570\u636E\uFF0C\u8BF7\u5237\u65B0
${c.message.slice(0,50)}`)),fetch(Se).then(c=>c.json()).then(c=>s.setAllIdioms(c)).catch(c=>E(`\u65E0\u6CD5\u83B7\u53D6\u6570\u636E\uFF0C\u8BF7\u5237\u65B0
${c.message.slice(0,50)}`)),(c,f)=>(u(),a(v,null,[d(n).answerIdiom&&d(n).answerOrigPinyin?(u(),y(we,{key:0,modelValue:r.value,"onUpdate:modelValue":f[0]||(f[0]=m=>r.value=m),answer:d(n).answerIdiom,"answer-pinyin":d(n).answerOrigPinyin},null,8,["modelValue","answer","answer-pinyin"])):B("",!0),V(Ae,{modelValue:h.value,"onUpdate:modelValue":f[1]||(f[1]=m=>h.value=m),excluded:d(n).excludeList,included:d(n).includeList},null,8,["modelValue","excluded","included"]),o("div",je,[o("div",Ge,[o("button",{class:"bg-blue-500 text-white rounded-md px-2 py-1",onClick:$}," \u91CD\u5F00 "),Le,o("button",{class:"bg-red-400 text-white rounded-md px-2 py-1",onClick:f[2]||(f[2]=m=>(r.value=!0,p.value=!0))}," \u653E\u5F03 ")]),d(n).guesses.length?(u(),a("div",Re,[o("div",qe,[V(Ee,{hints:d(n).hints},null,8,["hints"]),o("button",{class:"bg-teal-500 text-white rounded-md px-2 my-1",onClick:f[3]||(f[3]=m=>h.value=!0)}," \u67E5\u770B\u6392\u9664 ")]),o("div",Ne,[(u(!0),a(v,null,_(d(n).guesses,(m,W)=>(u(),y(he,{key:W,idiom:m.idiom,pinyin:m.pinyin,"guess-results":m.result},null,8,["idiom","pinyin","guess-results"]))),128))])])):(u(),y(Pe,{key:1})),Me,o("div",Ue,[V(K,null,{default:I(()=>[t.value?(u(),a("div",ze,g(t.value),1)):B("",!0)]),_:1}),o("div",Ke,[Q(o("input",{"onUpdate:modelValue":f[4]||(f[4]=m=>i.value=m),maxlength:"4",disabled:d(P),class:"rounded-l px-2 w-48","w:border":"1 solid gray-300","w:focus":"ring ring-blue-400 border-blue-400","w:disabled":"bg-gray-100",onKeyup:Y(S,["enter"])},null,40,Te),[[X,i.value]]),o("button",{class:"rounded-r w-16",disabled:d(P),"w:p":"x-4 y-2","w:bg":"blue-500 hover:blue-600 active:blue-700 disabled:blue-gray-400","w:text":"white",onClick:S}," \u786E\u8BA4 ",8,He)])])])],64))}});const H=Z(We);H.use(ee());H.mount("#app");
